link_mpi_libs=""
cxx_mpi_defs=""
mpi_compiler="g++"


AC_ARG_ENABLE(mpi-layer,
                [  --enable-mpi-layer[=LAYER]  	Specify the mpi layer:
            				lam
            				mpich
            				sicortex
            				sicortex-debug ],
            ok=${enableval},
            ok="no")

if test "${ok}" != "no"
then

   case "${ok}" in 
        lam)
            AC_MSG_RESULT(enabling lam...)
            mpi_compiler="mpiCC"
        ;;
        mpich)
            AC_MSG_RESULT(enabling mpich...)
            mpi_compiler="mpicxx"
            cxx_mpi_defs="-DMPICH_IGNORE_CXX_SEEK"
        ;;
        sicortex)
            AC_MSG_RESULT(enabling sicortex mpi...)
            link_mpi_libs="-lscmpicxx -lscmpi"
            cxx_mpi_defs="-DMPICH_IGNORE_CXX_SEEK"
        ;;
        sicortex-debug)
            AC_MSG_RESULT(enabling debug sicortex mpi...)
            link_mpi_libs="-lscmpicxx -lscmpi_debug"
            cxx_mpi_defs="-DMPICH_IGNORE_CXX_SEEK"
        ;;
    esac
fi

AC_SUBST(cxx_mpi_defs)
AC_SUBST(link_mpi_libs)
AC_SUBST(mpi_compiler)
